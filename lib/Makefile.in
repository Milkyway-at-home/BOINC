DEPTH   = ..
topsrcdir       = @top_srcdir@
srcdir          = @srcdir@
VPATH           = @srcdir@

INSTALL_DIR = $(INSTALL_DIR)

VERSION = 1

CFLAGS = -g

CC = @CC@ $(CFLAGS) -I ../RSAEuro/source

PROGS = md5_test shmem_test synch_test crypt_prog

OBJS = \
    countries.o \
    parse.o

MD5_OBJS = \
    md5.o \
    md5_file.o

CRYPT_OBJS = \
    crypt.o

CRYPT_LIBS = \
    $(MD5_OBJS) \
    ../RSAEuro/source/rsaeuro.a

COUNTRY_OBJS = \
    countries.o

all: $(PROGS) $(OBJS) $(MD5_OBJS) $(CRYPT_OBJS)

.C.o:
	$(CC) -c -o $*.o $<
.c.o:
	$(CC) -c -o $*.o $<

md5_test: md5_test.o $(MD5_OBJS)
	$(CC) md5_test.o $(MD5_OBJS) -o md5_test

shmem_test: shmem_test.o shmem.o
	$(CC) shmem_test.o shmem.o -o shmem_test

synch_test: synch_test.o synch.o
	$(CC) synch_test.o synch.o -o synch_test

crypt_prog: crypt_prog.o crypt.o 
	$(CC) crypt_prog.o crypt.o $(CRYPT_LIBS) -o crypt_prog

clean:
	rm -f *.o $(PROGS) core dependencies

install: all
	-mkdir -p $(INSTALL_DIR)/lib
	cp md5_test $(INSTALL_DIR)/lib/md5_test
	cp shmem_test $(INSTALL_DIR)/lib/shmem_test
	cp synch_test $(INSTALL_DIR)/lib/synch_test
	cp crypt_prog $(INSTALL_DIR)/lib/crypt_prog

uninstall:
	$(RM) -r $(INSTALL_DIR)/lib

dependencies: @srcdir@/*.C
	$(CC) -M @srcdir@/*.C > dependencies

include dependencies
