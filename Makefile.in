SHELL = /bin/sh

DEPTH	= .
topsrcdir	= @top_srcdir@
srcdir	= @srcdir@
VPATH	= @srcdir@

INSTALL_DIR = /usr/local/boinc

#
#	The ../$(srcdir)/client/configure
#	only works when the original configure is relative path
#	it doesn't work when it is an absolute path
#	This needs to be fixed
#
all:
	echo $(APACHE_MSG)
	cd RSAEuro/source; ${MAKE}; cd ../..; \
	cd db; ${MAKE}; cd ..; \
	cd lib; ${MAKE}; cd ..; \
	cd api; ${MAKE}; cd ..; \
	cd apps; ${MAKE}; cd ..; \
	cd client; ../$(srcdir)/client/configure; ${MAKE}; cd ..; \
	cd sched; ${MAKE}; cd ..; \
	cd tools; ${MAKE}; cd ..;

clean:
	rm -f boinc.tar.gz config.cache; \
	cd RSAEuro/source/; ${MAKE} clean; cd ../../; \
	cd db; ${MAKE} clean; cd ..; \
	cd lib; ${MAKE} clean; cd ..; \
	cd api; ${MAKE} clean; cd ..; \
	cd apps; ${MAKE} clean; cd ..; \
	cd client; ${MAKE} clean; cd ..; \
	cd sched; ${MAKE} clean; cd ..; \
	cd tools; ${MAKE} clean; cd ..;

install: all
	-mkdir -p $(INSTALL_DIR);
	cd sched; ${MAKE} install;
	cd lib; ${MAKE} install;
	cd api; ${MAKE} install;
	cd apps; ${MAKE} install;
	cd client; ${MAKE} install;
	cd tools; ${MAKE} install;
	$(CP) -r test /usr/local/boinc;

uninstall:
	cd sched; ${MAKE} uninstall;
	cd lib; ${MAKE} uninstall;
	cd api; ${MAKE} uninstall;
	cd apps; ${MAKE} uninstall;
	cd client; ${MAKE} uninstall;
	cd tools; ${MAKE} uninstall;
	$(RM) -r $(INSTALL_DIR)/tools;

tar: clean
	tar cf boinc.tar * ; gzip boinc.tar

client_tar: clean
	cd client; ${MAKE} tar;
